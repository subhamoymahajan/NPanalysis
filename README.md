# NPanalysis - An analysis tool for two-component nanoparticles

NP(nanoparticle)analysis is a tool to analyze nanoparticle properties in all-atom or coarse-grained molecular dynamics systems. The scripts are written for DNA-PEI nanoparticles, but can be used for other two-component nanoparticles. It can currently only read [Gromacs](https://manual.gromacs.org/archive/5.0.4/online/gro.html) **.gro** and **.xvg** files generated by Gromacs to calculate different properties:

1. Connection matrix of molecules
2. Number of molecules performing different roles
3. Cluster analysis to calculate different molecules in a nanoparticle
4. Calculating the size of the nanoparticle in terms of number of molecules of one type (DNA or PEI)
5. Calculating size distribution of nanoparticles
6. Charge of nanoparticles as a function of size
7. Make nanoparticles whole across periodic boundaries
7. Radius of gyration, and hydrodynamic radius of nanoparticle as a function of time
8. Radius of gyration, and hydrodynamic radius of nanoparticle as a function of size

## Installation

NPanalysis can be installed as a module using
 
```bash
python setup.py install --user
```
<----
##Quickstart

### Prepare Gromacs files

First make molecules whole across periodic boundaries and output **.gro** files:

```bash
gmx trjconv -f md_1.xtc -s md_1.tpr -pbc whole -o Whole/DP.gro -sep
```

Output the mass data:

```bash
gmx dump -s md_1.tpr > tpr.dump
```

### Calculate connection matrix

Generate a constants file 'constants.dat':

```bash
ndna = 27 # number of DNA 
npei = 270 # number of PEI
adna = 154 # number of DNA atoms
apei = 13 # number of PEI atoms
Qdna = -22 # Charge of DNA
Qpei = 3 # Charge of PEI
sdna = 1 # first atom of DNA
spei = 4159 # first atom of PEI
contact_dist = 0.5 # contact distance threshold
pbc = xyz

```

Read constants from the file and pickle it:

```python
import NPanalysis as NPa
NPa.pickle_constants('constants.dat')
```

Generate molecule ID index or read it:
```python
NPa.gmx.gen_index_mol('molndx.pickle')
NPa.gmx.read_index('index.ndx')
```
Read and pickle mass information:

```python
NPa.gmx.pickle_mass('tpr.dump')
```

Calculate connection matrix:

```python
NPa.connMat.gro2connected(inGRO='Whole/DP')
```
Calculate PEI roles:

Average over 50 timesteps and output to 'PEI\_roles.dat'

```python
NPa.connMat.get_roles(50,'PEI_roles.dat')
NPa.connMat.get_roles2(50,'PEI')
```
----->


